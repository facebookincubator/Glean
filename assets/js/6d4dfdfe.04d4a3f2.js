"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5500],{15680:(e,n,t)=>{t.r(n),t.d(n,{MDXContext:()=>d,MDXProvider:()=>p,mdx:()=>g,useMDXComponents:()=>m,withMDXComponents:()=>c});var a=t(96540);function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(){return r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},r.apply(this,arguments)}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){o(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,o=function(e,n){if(null==e)return{};var t,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||(o[t]=e[t]);return o}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)t=r[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var d=a.createContext({}),c=function(e){return function(n){var t=m(n.components);return a.createElement(e,r({},n,{components:t}))}},m=function(e){var n=a.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=m(e.components);return a.createElement(d.Provider,{value:n},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},f=a.forwardRef((function(e,n){var t=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=m(t),p=o,u=c["".concat(l,".").concat(p)]||c[p]||h[p]||r;return t?a.createElement(u,i(i({ref:n},d),{},{components:t})):a.createElement(u,i({ref:n},d))}));function g(e,n){var t=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var r=t.length,l=new Array(r);l[0]=f;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[u]="string"==typeof e?e:o,l[1]=i;for(var d=2;d<r;d++)l[d]=t[d];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}f.displayName="MDXCreateElement"},67555:(e,n,t)=>{t.d(n,{D4:()=>l,Lw:()=>i,gD:()=>s});var a=t(96540),o=t(14423);let r;function l(e){return a.createElement("a",{href:r+e.file},e.file)}function i(e){return a.createElement("a",{href:r+e.file},e.children)}r=(0,o.isInternal)()?"https://www.internalfb.com/code/fbsource/fbcode/":"https://github.com/facebookincubator/Glean/tree/master/";const s=e=>{let{children:n,internal:t,external:r}=e;return(0,o.fbContent)({internal:a.createElement("code",null,t),external:a.createElement("code",null,r)})}},81895:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var a=t(58168),o=(t(96540),t(15680)),r=t(67555);const l={slug:"release-0-2",title:"Glean Release 0.2",author:"Simon Marlow",author_title:"Simon Marlow",author_url:"https://simonmar.github.io/",author_image_url:"http://simonmar.github.io/images/simonmarlow.jpg",tags:["glean","release"]},i=void 0,s={permalink:"/blog/release-0-2",source:"@site/blog/2026-02-06-glean-0-2.md",title:"Glean Release 0.2",description:"I just uploaded",date:"2026-02-06T00:00:00.000Z",formattedDate:"February 6, 2026",tags:[{label:"glean",permalink:"/blog/tags/glean"},{label:"release",permalink:"/blog/tags/release"}],readingTime:9.07,hasTruncateMarker:!1,authors:[{name:"Simon Marlow",title:"Simon Marlow",url:"https://simonmar.github.io/",imageURL:"http://simonmar.github.io/images/simonmarlow.jpg"}],frontMatter:{slug:"release-0-2",title:"Glean Release 0.2",author:"Simon Marlow",author_title:"Simon Marlow",author_url:"https://simonmar.github.io/",author_image_url:"http://simonmar.github.io/images/simonmarlow.jpg",tags:["glean","release"]},nextItem:{title:"Incremental indexing with Glean",permalink:"/blog/incremental"}},d={authorsImageUrls:[void 0]},c=[{value:"Changes in 0.2.0.0",id:"changes-in-0200",level:2},{value:"Examples",id:"examples",level:2},{value:"Index LLVM + Clang and browse it in VS Code",id:"index-llvm--clang-and-browse-it-in-vs-code",level:3},{value:"Download a DB of Stackage and try some queries",id:"download-a-db-of-stackage-and-try-some-queries",level:3},{value:"Index your own Haskell code",id:"index-your-own-haskell-code",level:3},{value:"Run a Glass server and make some simple queries",id:"run-a-glass-server-and-make-some-simple-queries",level:3}],m={toc:c},p="wrapper";function u(e){let{components:n,...t}=e;return(0,o.mdx)(p,(0,a.A)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.mdx)("p",null,"I just uploaded\n",(0,o.mdx)("a",{parentName:"p",href:"https://hackage.haskell.org/package/glean-0.2.0.0"},"glean-0.2.0.0")," to\nHackage, along with releases of the Haskell Thrift compiler and other\ndependencies."),(0,o.mdx)("p",null,"Since version 0.1.0.0, Glean has been installable using plain ",(0,o.mdx)("inlineCode",{parentName:"p"},"cabal\ninstall")," which vastly improves on the previous complex build\nprocess. For full details, see ",(0,o.mdx)("a",{parentName:"p",href:"https://glean.software/docs/building/"},"Building Glean From\nSource"),", but to summarise: on a\nrecent Linux distro, with GHC 9.2-9.6 and cabal 3.6+, install some\nprerequisite system packages (listed in the building docs above), and\nthen just"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"cabal install glean\n")),(0,o.mdx)("p",null,'The build takes a while, partly because one of the dependencies is a\ncabal-packaged copy of the "folly" C++ library\n(',(0,o.mdx)("a",{parentName:"p",href:"https://hackage.haskell.org/package/folly-clib"},"folly-clib"),") and\n",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/haskell/cabal/issues/7127"},"cabal doesn't currently build C++ files in\nparallel"),"."),(0,o.mdx)("h2",{id:"changes-in-0200"},"Changes in 0.2.0.0"),(0,o.mdx)("p",null,"Some pretty big things have landed:"),(0,o.mdx)("ul",null,(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Glean now comes with a generic LSP server,\n",(0,o.mdx)("a",{parentName:"p",href:"https://hackage.haskell.org/package/glean-lsp"},"glean-lsp"),", which\nsupports common IDE operations like go-to-definition,\ngo-to-references, hover documentation, and symbol search. This means\nyou can index a software project with Glean and then browse it using\nVS Code (for example). I'll give a couple of worked examples below\nshowing step-by-step how to do this for some real world codebases.")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Glean has a new experimental DB backend based on\n",(0,o.mdx)("a",{parentName:"p",href:"https://www.symas.com/mdb"},"LMDB"),". LMDB is much smaller and simpler\nthan RocksDB, and in most of our benchmarks it performed around\n30-40% better. We're still investigating some performance issues\nencountered with very large indexing jobs, though. Currently it's\nstill not possible to build Glean without the RockDB dependency,\nbut we do intend to fix this in the future.")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"Added a new Haskell indexer that consumes ",(0,o.mdx)("inlineCode",{parentName:"p"},".hie")," files directly, and\ncollects much richer data than the old indexer - in particular it\nindexes local variables and collects type information for all\nvariable occurrences, which appears on hover with ",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-lsp")," and VS\nCode.")),(0,o.mdx)("li",{parentName:"ul"},(0,o.mdx)("p",{parentName:"li"},"We're now also releasing the C++ indexer as a Cabal package along\nwith Glean:\n",(0,o.mdx)("a",{parentName:"p",href:"https://hackage.haskell.org/package/glean-clang"},"glean-clang"),", so\nGlean can be used to index C++ projects out of the box."))),(0,o.mdx)("h2",{id:"examples"},"Examples"),(0,o.mdx)("p",null,"Here are a couple of things you can play with, once you've ",(0,o.mdx)("a",{parentName:"p",href:"https://glean.software/docs/building/"},"built and\ninstalled Glean"),"."),(0,o.mdx)("h3",{id:"index-llvm--clang-and-browse-it-in-vs-code"},"Index LLVM + Clang and browse it in VS Code"),(0,o.mdx)("p",null,"Clone an LLVM source tree:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"git clone https://github.com/llvm/llvm-project.git\n")),(0,o.mdx)("p",null,"Configure, including Clang. This step also produces the\n",(0,o.mdx)("inlineCode",{parentName:"p"},"compile_commands.json")," file that Glean will later use during\nindexing:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"cd llvm-project/llvm\nmkdir build && cd build\ncmake -DCMAKE_EXPORT_COMPILE_COMMANDS=1 -DCMAKE_BUILD_TYPE=Debug -DLLVM_ENABLE_PROJECTS=clang ..\n")),(0,o.mdx)("p",null,"Next, build LLVM. This step is required because LLVM includes a lot of\ngenerated code which is produced as part of the build process, so to\nindex the source files we need to ensure all the generated code has\nbeen built first."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"cmake --build . -j12\n")),(0,o.mdx)("p",null,"Go and get a coffee. Or two. (beware, even with 32GB this tends to OOM\nmy laptop, so you might want to reduce ",(0,o.mdx)("inlineCode",{parentName:"p"},"-j12")," to something\nlower). Next, we can index the project using Glean's C++\nindexer."),(0,o.mdx)("p",null,"If you haven't already install Glean's C++ indexer, do that:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"cabal install glean-clang\n")),(0,o.mdx)("p",null,"Next we'll run the indexer. We'll store the resulting DB in\n",(0,o.mdx)("inlineCode",{parentName:"p"},"llvm-project/gleandb")," for now."),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'cd ..\nglean --db-root gleandb index cpp-cmake --db llvm/1 --cdb-dir "$(pwd)/llvm/build" . -j12\n')),(0,o.mdx)("p",null,"Go and get another coffee... this is essentially running the compiler\nover all the C++ code again. It ",(0,o.mdx)("em",{parentName:"p"},"should")," need no more than 16GB or so\nwith 12 indexer processes running in parallel."),(0,o.mdx)("p",null,"Note that you need to do this from the ",(0,o.mdx)("inlineCode",{parentName:"p"},"llvm-project")," directory, this\nensures that the filenames in the Glean DB will be relative to that\ndirectory which is what ",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-lsp")," expects. (Storing the data under\nthe wrong filenames is the most common cause of things not working\nwhen we connect up the full IDE/LSP/Glean stack)."),(0,o.mdx)("p",null,"Next we need to set up VS Code and ",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-lsp"),". There are full\ninstructions for ",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-lsp")," in its ",(0,o.mdx)(r.Lw,{file:"lsp/README.md",mdxType:"SrcFileLink"},"README"),", but here's specifically how\nto set it up for LLVM using the index we just created."),(0,o.mdx)("p",null,"First install ",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-lsp")," if you haven't already:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"cabal install glean-lsp\n")),(0,o.mdx)("p",null,"To use this LSP server with VS Code, you need a generic LSP client\nsuch as ",(0,o.mdx)("a",{parentName:"p",href:"https://github.com/zsol/vscode-glspc"},"Generic LSP Client\n(v2)"),". Install that extension in\nVS Code, and then create ",(0,o.mdx)("inlineCode",{parentName:"p"},"llvm-project/.vscode/settings.json"),":"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'[\n    "glean-lsp": {\n        "repo": "llvm"\n    },\n    "glspc.server.command": "glean-lsp"\n    "glspc.server.commandArguments": ["--db-root", "gleandb"],\n    "glspc.server.languageId": [\n      "cpp", "c"\n    ]\n}\n')),(0,o.mdx)("p",null,'Now in VS Code, "Open Folder" and select the ',(0,o.mdx)("inlineCode",{parentName:"p"},"llvm-project")," folder. If\nyou have another C++ extension installed, it probably makes sense to\ndisable it for this folder, otherwise you'll see responses from both\nextensions for things like go-to-definition."),(0,o.mdx)("p",null,"Open a source file,\ne.g. ",(0,o.mdx)("inlineCode",{parentName:"p"},"llvm-project/clang/include/clang/AST/Decl.h"),'.  You should have\ncode navigation features available: holding down Ctrl while moving the\nmouse around should underline identifiers, and clicking on an\nidentifier should jump to its definition. You should be able to\nright-click "Go to References" on a definition to find references\nthroughout the whole LLVM + Clang tree instantly, and ',(0,o.mdx)("inlineCode",{parentName:"p"},"Ctrl+T")," for\nsymbol search should work. Hovering the mouse over an identifier\nshould show its type."),(0,o.mdx)("p",null,"If things aren't working, then the first place to look for problems is in\nthe output window for the Generic LSP Client: show the Output window,\nand then select Generic LSP Client from the dropdown on the right."),(0,o.mdx)("p",null,"You can also open the DB in Glean's shell to check that it looks right:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"glean shell --db-root llvm-project/gleandb --db llvm\n")),(0,o.mdx)("p",null,"Try e.g. ",(0,o.mdx)("inlineCode",{parentName:"p"},":stat")," to see the contents, and try ",(0,o.mdx)("inlineCode",{parentName:"p"},"src.File _")," to show\nknown source files."),(0,o.mdx)("h3",{id:"download-a-db-of-stackage-and-try-some-queries"},"Download a DB of Stackage and try some queries"),(0,o.mdx)("p",null,"You can ",(0,o.mdx)("a",{parentName:"p",href:"https://drive.google.com/file/d/1rixJ6VCl6OlsECGnSjsH6IlXxFUU_msD/view?usp=sharing"},"download a DB of Stackage\n21.21"),"\nand try some queries. This DB was produced by building ~3000 packages\nin Stackage 21.21 and then producing a Glean DB from the ",(0,o.mdx)("inlineCode",{parentName:"p"},".hie")," files;\nfor more details see ",(0,o.mdx)("a",{parentName:"p",href:"https://simonmar.github.io/posts/2025-05-22-Glean-Haskell.html"},"Indexing Hackage: Glean\nvs. hiedb"),"."),(0,o.mdx)("p",null,"Unpack the DB:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"mkdir /tmp/glean && tar xf glean-stackage-21.21.tar -C /tmp/glean\n")),(0,o.mdx)("p",null,"and start the Glean shell:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"$ glean shell --db-root /tmp/glean\nGlean Shell, built on 2025-07-14 13:39:35.711312749 UTC, from rev <unknown>\nUsing local DBs from rocksdb:/tmp/glean\ntype :help for help.\n> \n")),(0,o.mdx)("p",null,"Load the DB:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"> :db stackage/1\nstackage>\n")),(0,o.mdx)("p",null,"Let's see what's in it:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"stackage> :stat\nhs.ClassDecl.3\n  count: 6503\n  size:  350074 (341.87 kiB) 0.0309%\nhs.ConstrDecl.3\n  count: 89371\n  size:  4048652 (3.86 MiB) 0.3569%\nhs.DataDecl.3\n  count: 40711\n  size:  2017999 (1.92 MiB) 0.1779%\n...\nTotal: 21735709 facts (1.06 GiB)\n")),(0,o.mdx)("p",null,"Let's find the class declaration for ",(0,o.mdx)("inlineCode",{parentName:"p"},"Hashable"),". First we have to find\nits name:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'stackage> hs.Name { occ = { name = "Hashable" }}\n{\n  "id": 11500325,\n  "key": {\n    "occ": { "id": 11923, "key": { "name": "Hashable", "namespace_": 3 } },\n    "mod": {\n      "id": 733072,\n      "key": {\n        "name": { "id": 733071, "key": "Language.Preprocessor.Cpphs.SymTab" },\n        "unit": { "id": 560159, "key": "cpphs-1.20.9.1-inplace" }\n      }\n    },\n    "sort": { "external": { } }\n  }\n}\n...\n5 results, 20 facts, 7.40ms, 316816 bytes, 914 compiled bytes\n')),(0,o.mdx)("p",null,"We got 5 results, and only one of them was the one we wanted. So let's\nrestrict the query to find only results in the ",(0,o.mdx)("inlineCode",{parentName:"p"},"hashable")," package:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'stackage> hs.Name { occ = { name = "Hashable" }, mod = { unit = "hashable".. }}\n{\n  "id": 11924,\n  "key": {\n    "occ": { "id": 11923, "key": { "name": "Hashable", "namespace_": 3 } },\n    "mod": {\n      "id": 11922,\n      "key": {\n        "name": { "id": 11920, "key": "Data.Hashable.Class" },\n        "unit": { "id": 11921, "key": "hashable-1.4.3.0-inplace" }\n      }\n    },\n    "sort": { "external": { } }\n  }\n}\n\n1 results, 5 facts, 1.18ms, 353848 bytes, 1489 compiled bytes\n')),(0,o.mdx)("p",null,"OK, now let's find the class declaration:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'stackage> hs.ClassDecl { name = { occ = { name = "Hashable" }, mod = { unit = "hashable".. }}}\n{\n  "id": 19072033,\n  "key": {\n    "name": {\n      "id": 11924,\n      "key": {\n        "occ": { "id": 11923, "key": { "name": "Hashable", "namespace_": 3 } },\n        "mod": {\n          "id": 11922,\n          "key": {\n            "name": { "id": 11920, "key": "Data.Hashable.Class" },\n            "unit": { "id": 11921, "key": "hashable-1.4.3.0-inplace" }\n          }\n        },\n        "sort": { "external": { } }\n      }\n    },\n    "methods": [\n      {\n...\n}\n\n1 results, 15 facts, 6.45ms, 514328 bytes, 1777 compiled bytes\n')),(0,o.mdx)("p",null,"Let's find the method names of the class:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'stackage> (C.methods[..]).name.occ.name where C = hs.ClassDecl { name = { occ = { name = "Hashable" }, mod = { unit = "hashable".. }}}\n{ "id": 21736733, "key": "hashWithSalt" }\n{ "id": 21736734, "key": "hash" }\n')),(0,o.mdx)("p",null,"And finally, let's see how many instances in Stackage 21.21 provide a\ndefinition of ",(0,o.mdx)("inlineCode",{parentName:"p"},"hashWithSalt"),":"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'stackage> :count I where B = hs.InstanceBind { name = { occ = { name = "hashWithSalt" }, mod = { unit = "hashable".. }}}; hs.InstanceBindToDecl { bind = B, decl = { inst = I }}; \n\n267 results, 267 facts, 26.40ms, 644736 bytes, 2462 compiled bytes\n')),(0,o.mdx)("p",null,"To see where these instance declarations are:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},'stackage> I.loc where B = hs.InstanceBind { name = { occ = { name = "hashWithSalt" }, mod = { unit = "hashable".. }}}; hs.InstanceBindToDecl { bind = B, decl = { inst = I }}\n{\n  "id": 21736733,\n  "key": {\n    "file": { "id": 3982208, "key": "text-latin1-0.3.1/src/Text/Latin1.hs" },\n    "span": { "start": 2662, "length": 157 }\n  }\n}\n{\n  "id": 21736734,\n  "key": {\n    "file": { "id": 11054592, "key": "shake-0.19.7/src/General/Thread.hs" },\n    "span": { "start": 526, "length": 87 }\n  }\n}\n{\n  "id": 21736735,\n  "key": {\n    "file": { "id": 5786370, "key": "strict-tuple-0.1.5.3/src/Data/Tuple/Strict/T6.hs" },\n    "span": { "start": 1887, "length": 265 }\n  }\n}\n...\n')),(0,o.mdx)("p",null,"There are also some example queries in an ",(0,o.mdx)("a",{parentName:"p",href:"https://simonmar.github.io/posts/2025-05-22-Glean-Haskell.html"},"earlier blog\npost")," (however, the"),(0,o.mdx)(r.Lw,{file:"glean/schema/source/hs.angle",mdxType:"SrcFileLink"},"schema"),"for Haskell has changed in a few ways since that post so some of the queries might not work exactly as written).",(0,o.mdx)("h3",{id:"index-your-own-haskell-code"},"Index your own Haskell code"),(0,o.mdx)("p",null,"To index the code of a Cabal package, add the following to your ",(0,o.mdx)("inlineCode",{parentName:"p"},"cabal.project"),":"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"package *\n    ghc-options:\n        -fwrite-ide-info\n        -hiedir .hiefiles\n")),(0,o.mdx)("p",null,"Then"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"$ cabal build\n$ glean index haskell-hie --db-root /tmp/glean --db mydb/1 .hiefiles\n")),(0,o.mdx)("p",null,"and then you can query the new DB in the shell:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"$ glean shell --db-root /tmp/glean --db mydb/1\n")),(0,o.mdx)("h3",{id:"run-a-glass-server-and-make-some-simple-queries"},"Run a Glass server and make some simple queries"),(0,o.mdx)("p",null,'Glass is a "symbol server", it provides a higher-level interface to\nthe Glean data, with operations like ',(0,o.mdx)("inlineCode",{parentName:"p"},"documentSymbols")," for finding all\nthe symbols in a file, and ",(0,o.mdx)("inlineCode",{parentName:"p"},"findReferences")," for finding all the\nreferences to a symbol. I used Glass to connect VS Code to Glean in\nthe ",(0,o.mdx)("a",{parentName:"p",href:"https://simonmar.github.io/posts/2025-06-11-Glean-stackage-vscode.html"},"previous blog\npost"),"."),(0,o.mdx)("p",null,"Glass makes requests to a Glean server, so we need to start both\n",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-server")," and ",(0,o.mdx)("inlineCode",{parentName:"p"},"glass-server"),", like this:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"$ glean-server --db-root /tmp/glean --port 12345\n")),(0,o.mdx)("p",null,"and in another terminal:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"$ glass-server --service localhost:12345 --port 12346\n")),(0,o.mdx)("p",null,"then we can make requests using ",(0,o.mdx)("inlineCode",{parentName:"p"},"glean-democlient"),", for example to\nlist the symbols in the file ",(0,o.mdx)("inlineCode",{parentName:"p"},"src/Data/Aeson.hs")," in the ",(0,o.mdx)("inlineCode",{parentName:"p"},"aeson-2.1.2.1")," package:"),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"$ glass-democlient --service localhost:12346 list stackage/aeson-2.1.2.1/src/Data/Aeson.hs\nstackage/hs/aeson/Data/Aeson/var/eitherDecodeFileStrict\nstackage/hs/aeson/Data/Aeson/var/eitherDecodeFileStrict%27\nstackage/hs/aeson/Data/Aeson/var/eitherDecodeStrict\nstackage/hs/aeson/Data/Aeson/var/fp/4335/2\nstackage/hs/aeson/Data/Aeson/var/eitherDecodeStrict%27\nstackage/hs/aeson/Data/Aeson/tyvar/a/6101/50\nstackage/hs/aeson/Data/Aeson/tyvar/a/6563/56\nstackage/hs/aeson/Data/Aeson/var/encodeFile\nstackage/hs/aeson/Data/Aeson/tyvar/a/7047/61\n...\n")),(0,o.mdx)("p",null,'Each of those symbols is a "Symbol ID", which is a string that\nuniquely identifies a particular symbol to Glass. Using the Symbol ID\nwe can find all the references to a symbol:'),(0,o.mdx)("pre",null,(0,o.mdx)("code",{parentName:"pre"},"")))}u.isMDXComponent=!0},80510:function(e,n,t){var a=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(o,r){function l(e){try{s(a.next(e))}catch(n){r(n)}}function i(e){try{s(a.throw(e))}catch(n){r(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}s((a=a.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.getSpecInfo=void 0;const o=t(88266);n.getSpecInfo=function(e){return a(this,void 0,void 0,(function*(){return yield o.call({module:"bloks",api:"getSpecInfo",args:{styleId:e}})}))}},88266:function(e,n){var t=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(o,r){function l(e){try{s(a.next(e))}catch(n){r(n)}}function i(e){try{s(a.throw(e))}catch(n){r(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}s((a=a.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.call=void 0;let a=!1,o=0;const r={};n.call=function(e){return t(this,void 0,void 0,(function*(){if("staticdocs.thefacebook.com"!==window.location.hostname&&"localhost"!==window.location.hostname)return Promise.reject(new Error("Not running on static docs"));a||(a=!0,window.addEventListener("message",(e=>{if("static-docs-bridge-response"!==e.data.event)return;const n=e.data.id;n in r||console.error(`Recieved response for id: ${n} with no matching receiver`),"response"in e.data?r[n].resolve(e.data.response):r[n].reject(new Error(e.data.error)),delete r[n]})));const n=o++,t=new Promise(((e,t)=>{r[n]={resolve:e,reject:t}})),l={event:"static-docs-bridge-call",id:n,module:e.module,api:e.api,args:e.args},i="localhost"===window.location.hostname?"*":"https://www.internalfb.com";return window.parent.postMessage(l,i),t}))}},70680:function(e,n,t){var a=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(o,r){function l(e){try{s(a.next(e))}catch(n){r(n)}}function i(e){try{s(a.throw(e))}catch(n){r(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}s((a=a.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.reportFeatureUsage=n.reportContentCopied=void 0;const o=t(88266);n.reportContentCopied=function(e){return a(this,void 0,void 0,(function*(){const{textContent:n}=e;try{yield o.call({module:"feedback",api:"reportContentCopied",args:{textContent:n}})}catch(t){}}))},n.reportFeatureUsage=function(e){return a(this,void 0,void 0,(function*(){const{featureName:n,id:t}=e;console.log("used feature");try{yield o.call({module:"feedback",api:"reportFeatureUsage",args:{featureName:n,id:t}})}catch(a){}}))}},14423:function(e,n,t){var a=this&&this.__createBinding||(Object.create?function(e,n,t,a){void 0===a&&(a=t),Object.defineProperty(e,a,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,a){void 0===a&&(a=t),e[a]=n[t]}),o=this&&this.__setModuleDefault||(Object.create?function(e,n){Object.defineProperty(e,"default",{enumerable:!0,value:n})}:function(e,n){e.default=n}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&a(n,e,t);return o(n,e),n};Object.defineProperty(n,"__esModule",{value:!0}),n.OssOnly=n.FbInternalOnly=n.getEphemeralDiffNumber=n.hasEphemeralDiffNumber=n.isInternal=n.validateFbContentArgs=n.fbInternalOnly=n.fbContent=n.inpageeditor=n.feedback=n.uidocs=n.bloks=void 0,n.bloks=r(t(80510)),n.uidocs=r(t(3730)),n.feedback=r(t(70680)),n.inpageeditor=r(t(45458));const l=["internal","external"];function i(e){return d(e),c()?"internal"in e?s(e.internal):[]:"external"in e?s(e.external):[]}function s(e){return"function"==typeof e?e():e}function d(e){if("object"!=typeof e)throw new Error(`fbContent() args must be an object containing keys: ${l}. Instead got ${e}`);if(!Object.keys(e).find((e=>l.find((n=>n===e)))))throw new Error(`No valid args found in ${JSON.stringify(e)}. Accepted keys: ${l}`);const n=Object.keys(e).filter((e=>!l.find((n=>n===e))));if(n.length>0)throw new Error(`Unexpected keys ${n} found in fbContent() args. Accepted keys: ${l}`)}function c(){try{return Boolean(!1)}catch(e){return console.log("process.env.FB_INTERNAL couldn't be read, maybe you forgot to add the required webpack EnvironmentPlugin config?",e),!1}}function m(){try{return null}catch(e){return console.log("process.env.PHABRICATOR_DIFF_NUMBER couldn't be read, maybe you forgot to add the required webpack EnvironmentPlugin config?",e),null}}n.fbContent=i,n.fbInternalOnly=function(e){return i({internal:e})},n.validateFbContentArgs=d,n.isInternal=c,n.hasEphemeralDiffNumber=function(){return Boolean(m())},n.getEphemeralDiffNumber=m,n.FbInternalOnly=function(e){return c()?e.children:null},n.OssOnly=function(e){return c()?null:e.children}},45458:function(e,n,t){var a=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(o,r){function l(e){try{s(a.next(e))}catch(n){r(n)}}function i(e){try{s(a.throw(e))}catch(n){r(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}s((a=a.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.submitDiff=void 0;const o=t(88266);n.submitDiff=function(e){return a(this,void 0,void 0,(function*(){const{file_path:n,new_content:t,project_name:a,diff_number:r}=e;try{return yield o.call({module:"inpageeditor",api:"createPhabricatorDiffApi",args:{file_path:n,new_content:t,project_name:a,diff_number:r}})}catch(l){throw new Error(`Error occurred while trying to submit diff. Stack trace: ${l}`)}}))}},3730:function(e,n,t){var a=this&&this.__awaiter||function(e,n,t,a){return new(t||(t=Promise))((function(o,r){function l(e){try{s(a.next(e))}catch(n){r(n)}}function i(e){try{s(a.throw(e))}catch(n){r(n)}}function s(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}s((a=a.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.getApi=n.docsets=void 0;const o=t(88266);n.docsets={BLOKS_CORE:"887372105406659"},n.getApi=function(e){return a(this,void 0,void 0,(function*(){const{name:n,framework:t,docset:a}=e;return yield o.call({module:"uidocs",api:"getApi",args:{name:n,framework:t,docset:a}})}))}}}]);