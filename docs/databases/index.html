<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Glean Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Glean Blog Atom Feed"><title data-react-helmet="true">Glean Databases | Glean</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Glean Databases | Glean"><meta data-react-helmet="true" name="description" content="Glean stores facts in databases."><meta data-react-helmet="true" property="og:description" content="Glean stores facts in databases."><meta data-react-helmet="true" property="og:url" content="https://glean.software/docs/databases"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://glean.software/docs/databases"><link rel="stylesheet" href="/styles.b813eb11.css">
<link rel="preload" href="/styles.18f92490.js" as="script">
<link rel="preload" href="/runtime~main.8501fd7b.js" as="script">
<link rel="preload" href="/main.003afee9.js" as="script">
<link rel="preload" href="/1.8bb08397.js" as="script">
<link rel="preload" href="/2.1e10b26e.js" as="script">
<link rel="preload" href="/1be78505.65acd90e.js" as="script">
<link rel="preload" href="/53.317f16e4.js" as="script">
<link rel="preload" href="/935f2afb.5adb77f3.js" as="script">
<link rel="preload" href="/52.9d98051a.js" as="script">
<link rel="preload" href="/0b852be5.5aec20ea.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<div style="display: none; text-align: center; background-color: white; color: black;" id="internaldocs-banner"></div><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><strong class="navbar__title">Glean</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/introduction">Documentation</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><strong class="navbar__title">Glean</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/introduction">Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Quick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/fb/internal">Glean at Facebook</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/trying">Trying Glean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/building">Building Glean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/walkthrough">Walkthrough</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">User Guide</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Schemas</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/basic">Basic Concepts</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/types">Built-in Types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/syntax">Syntax</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/recursion">Recursion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/changing">Changing a schema</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/workflow">Workflow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/schema/thrift">Thrift and JSON</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Querying</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/query/intro">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Angle</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/intro">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/guide">Guide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/efficiency">Query Efficiency</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/advanced">Advanced Query Features</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/reference">Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/angle/style">Style Guide</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/query/api/haskell">Haskell</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/derived">Derived Predicates</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/databases">Glean Databases</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/write">Writing data to Glean</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/running">Running the Tools</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/shell">Using the Shell</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/server">Running the Glean Server</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cli">The Glean CLI tool</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Glean Databases</h1></header><div class="markdown"><p>Glean stores facts in databases.</p><p>A Glean database has:</p><ul><li>A <strong>name</strong>. This is often (but not always) the name of the source code repository from which the facts in the database were collected. Indeed, for historical reasons we sometimes say &quot;repository&quot; or &quot;repo&quot; when we mean &quot;database&quot;.</li><li>A <strong>hash</strong>. This is just an arbitrary string, used to distinguish different versions of databases with the same name. For source code repositories it can be the revision of the repository that was indexed.</li><li>Some <strong>properties</strong>. A database has a set of key-value pairs associated with it. Some of these are created by Glean itself, and others can be set by a client when the DB is created, or while writing facts. Properties can be used to store arbitrary metadata about the DB, and can be accessed cheaply.</li></ul><p>The name and hash together uniquely identify a database. This is written <code>&lt;name&gt;/&lt;hash&gt;</code>, and it is how you refer to a database in most cases when working with Glean. For example, in the shell&#x27;s <code>:db</code> command, or the <code>--repo</code> argument to the command-line tools.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="working-with-local-databases"></a>Working with local databases<a class="hash-link" href="#working-with-local-databases" title="Direct link to heading">#</a></h2><p>Most Glean tools (in particular the <a href="/docs/shell">shell</a> and the <a href="/docs/cli">CLI
tool</a>) can work either by talking to a <a href="/docs/server">Glean server</a> or
accessing databases on the local filesystem directly. The access
method is chosen by these command-line flags:</p><ul><li><code>--service &lt;tier&gt;</code> or <code>--service &lt;host&gt;:&lt;port&gt;</code>  Connect to a remote Glean server.</li><li><code>--db-root &lt;dir&gt;</code>  Use databases stored locally in the directory <code>&lt;dir&gt;</code></li></ul><p>These flags are accepted by all the Glean command-line tools, including <code>glean</code> and <code>glean-shell</code>.</p><p>To use the <a href="/docs/shell">shell</a> with local databases, you can do:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-lang=sh codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">mkdir /tmp/glean</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">glean-shell --db-root /tmp/glean</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>To run a server, see <a href="/docs/server">Running the Glean Server</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="lifecycle-of-a-database"></a>Lifecycle of a database<a class="hash-link" href="#lifecycle-of-a-database" title="Direct link to heading">#</a></h2><p>A database will typically be created by an automatic periodic job to
index the current state of a source repository.  The process works
like this:</p><div></div><ul><li><p>The job invokes <code>glean --service &lt;write-server&gt; kickoff &lt;args&gt;</code> to create the database.</p></li><li><p>At this point the database is in the <strong>Incomplete</strong> state. Queries
are supported in this state, and always reflect the current contents.</p></li><li><p>Facts are written to the database using the methods described in <a href="/docs/write">Writing data to Glean</a>, and finally the database is closed by invoking <code>glean --service &lt;write-server&gt; finish &lt;args&gt;</code> or the appropriate Thrift method.</p></li><li><p>The database is now in the <strong>Complete</strong> state.</p></li><li><p>If backups are allowed for this database, then:</p><ul><li>the write server uploads the database to backup storage.</li><li>servers that are configured to restore databases automatically can download the DB from backup storage, and use it to serve queries from clients.</li></ul></li></ul><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>There are currently no backup backends implemented for open-source Glean.</p></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/derived"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Derived Predicates</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/write"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Writing data to Glean Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#working-with-local-databases" class="table-of-contents__link">Working with local databases</a></li><li><a href="#lifecycle-of-a-database" class="table-of-contents__link">Lifecycle of a database</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/fbOpenSource" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebookincubator/glean" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://opensource.facebook.com" target="_blank" rel="noopener noreferrer" class="footerLogoLink_31Aa"><img class="footer__logo" alt="Facebook Open Source Logo" src="/img/oss_logo.png"></a></div><div class="footer__copyright">Copyright Â© 2021 Facebook, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/styles.18f92490.js"></script>
<script src="/runtime~main.8501fd7b.js"></script>
<script src="/main.003afee9.js"></script>
<script src="/1.8bb08397.js"></script>
<script src="/2.1e10b26e.js"></script>
<script src="/1be78505.65acd90e.js"></script>
<script src="/53.317f16e4.js"></script>
<script src="/935f2afb.5adb77f3.js"></script>
<script src="/52.9d98051a.js"></script>
<script src="/0b852be5.5aec20ea.js"></script>
</body>
</html>